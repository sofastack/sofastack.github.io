<!DOCTYPE html>
<html>

<head>
	<title>
	蚂蚁安全科技 Nydus 镜像加速实践 · SOFAStack
</title>
	<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="SOFAStack is a Scalable Open Financial Architecture for building cloud native applications" />

<meta name="generator" content="Hugo 0.55.5" /><link rel="shortcut icon" href=https://img.alicdn.com/imgextra/i3/O1CN019CRHyf1qyMghfS3id_!!6000000005564-2-tps-211-128.png type="image/png">

<link href="https://unpkg.com/purecss@1.0.0/build/base-min.css" rel="stylesheet">



<link href="/sofastack.tech/css/main.css" rel="stylesheet">
<link href="/sofastack.tech/css/zoom-image.css" rel="stylesheet">

<script src="/sofastack.tech/js/iconfont.js"></script>
<script src="/sofastack.tech/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>window.SITE_LANGUAGE = "zh"</script>
<script src="/sofastack.tech/js/app.js"></script>





<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-142131411-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>

<body>
	<header class="ss-header">
	<nav class="navbar" role="navigation" aria-label="main navigation">
		<div class="navbar-brand">
			<a class="logo-link" href="/sofastack.tech/">
				<img class="logo" src="/sofastack.tech/img/logo-2024.png">
			</a>
			<div class="-show-mobile">
				<a id="mobile-menu-icon">
					<svg class="icon" aria-hidden="true">
						<use xlink:href="#icon-menu"></use>
					</svg>
				</a>
				<nav id="mobile-menu">
						<div id="js-menu-search-mobile" class="navbar-search-mobile">
							<input class="input" placeholder="请输入要搜索的关键词">
							<svg class="icon" aria-hidden="true">
								<use xlink:href="#icon-search"></use>
							</svg>
						</div>
					
          
            <a
              class=""
              href="/sofastack.tech/projects/">
              <span>
                项目
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
            <a
              class=""
              href="/sofastack.tech/guides/">
              <span>
                指南
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
            <a
              class=""
              href="/sofastack.tech/blog/">
              <span>
                博客
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
            <a
              class=""
              href="/sofastack.tech/activities/">
              <span>
                活动
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
            <a
              class=""
              href="/sofastack.tech/community/">
              <span>
                社区
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
            <a
              class=""
              href="/sofastack.tech/awesome/">
              <span>
                Awesome SOFA
              </span>
              <svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"></use></svg>
            </a>
					
					
				</nav>
			</div>
		</div>

		<div class="navbar-menu -hidden-mobile">
			<div class="navbar-start">
				
				
					<a class="navbar-item "
						href="/sofastack.tech/projects/">项目</a>
				
					<a class="navbar-item "
						href="/sofastack.tech/guides/">指南</a>
				
					<a class="navbar-item "
						href="/sofastack.tech/blog/">博客</a>
				
					<a class="navbar-item "
						href="/sofastack.tech/activities/">活动</a>
				
					<a class="navbar-item "
						href="/sofastack.tech/community/">社区</a>
				
					<a class="navbar-item "
						href="/sofastack.tech/awesome/">Awesome SOFA</a>
				
			</div>
			<div class="navbar-end">
				<div class="navbar-item">
					<div id="js-menu-search" class="navbar-search">
						<input class="input" placeholder="请输入要搜索的关键词">
						<svg class="icon" aria-hidden="true">
							<use xlink:href="#icon-search"></use>
						</svg>
					</div>
				</div>
				<div class="navbar-item">
					
				</div>
			</div>
		</div>
	</nav>
</header>


	

	

	

	

	

	



	

<div class="ss-layout-container">
	<main class="ss-layout-main -card">
		<div class="ss-meta">
	<h1 class="title">
		蚂蚁安全科技 Nydus 镜像加速实践
	</h1>
	<div class="meta">
		
			2023-04-26 ·
			
				<a href="https://github.com/sofastack"></a> ·
			
			<span class="tags">
				
					<a class="tag" href="/sofastack.tech/tags/sofastack/" rel="tag">#SOFAStack</a>
				
			</span>
		
	</div>
</div>
		<article class="typo">
  <p>文｜蚂蚁集团 ZOLOZ 团队</p>

<p><strong>使用全球领先安全科技，为用户和机构提供安全、便捷的安全风控解决方案。</strong></p>

<p>本文 <strong>6386</strong> 字 阅读 <strong>12</strong> 分钟</p>

<p><strong>背景简介</strong></p>

<p>ZOLOZ[1]是蚂蚁集团旗下的全球安全风控平台，通过业内领先的生物识别、大数据分析和人工智能技术，为用户和机构提供安全又便捷的安全风控解决方案。ZOLOZ 已为中国、印尼、马来西亚、菲律宾等 14 个国家和地区的 70 余家合作伙伴提供数字化转型过程中的安全风控技术支持。目前，已经覆盖金融、保险、证券、信贷、电信、公众服务等领域，累计服务用户超 12 亿。</p>

<p>随着 Kubernetes 和云原生的大爆发，ZOLOZ 应用开始在公有云上进行大规模容器化部署。ZOLOZ 业务的镜像经过长期维护和更新，无论是镜像层数还是整体大小都达到了一个较大的量级 <em>（数百 MB 或者几个 GB）</em> 。特别是 ZOLOZ AI 算法推理应用的基础镜像大小要远大于一般应用镜像 <em>（Docker Hub 上 PyTorch/PyTorch：1.13.1-CUDA 11.6-cuDNN 8-Runtime 有 4.92GB，同比 CentOS：latest 只有约 234MB）</em> ，对于容器冷启动，即在本地无镜像的情况下，需要先从 Registry 下载镜像才能创建容器，在生产环境中，容器的冷启动往往耗时数分钟，并且随规模扩大会导致 Registry 因集群内网络拥堵而无法快速地下载镜像，如此庞大的镜像给应用的更新和扩容等操作都带来了不少挑战。在公有云上容器化持续推进的当下，ZOLOZ 应用主要遇到了三大挑战：</p>

<ol>
<li><p>算法镜像大，推送到云上镜像仓库耗时长，开发过程中，在使用测试环境进行测试时，往往希望快速迭代，快速验证，但是每次改完一个分支发布验证都要经过几十分钟，开发效率十分低下。</p></li>

<li><p>拉取算法镜像耗时长，在集群扩容大量机器拉取镜像文件会容易导致集群网卡被打满，影响业务正常运行。</p></li>

<li><p>集群机器拉起时间长，难以满足流量突增时，弹性自动扩缩容。</p></li>
</ol>

<p>虽然也尝试过各种折中的解决方案，但这些方案都有缺陷，现在结合蚂蚁、阿里云、字节跳动等多个技术团队打造了一套更通用的公有云上解决方案，该方案改造成本低，性能好，目前看来是比较理想的方案。</p>

<p><strong>术语及定义</strong></p>

<p><strong>OCI</strong>：Open Container Initiative，开放容器计划是一个 Linux 基金会项目，由 Docker 在 2015 年 6 月启动，旨在为操作系统级虚拟化 <em>（最重要的是 Linux 容器）</em> 设计开放标准。</p>

<p><strong>OCI Manifest</strong>：遵循 OCI Image Spec 的制品。</p>

<p><strong>BuildKit</strong>：是 Docker 公司出品的一款更高效、Dockerfile 无关、更契合云原生应用的新一代 Docker 构建工具。</p>

<p><strong>镜像</strong>：本文中的镜像指 OCI Manifest，也包括 Helm Chart 等其他 OCI Manifest。</p>

<p><strong>镜像仓库</strong>：遵循 OCI Distribution Spec 实现的制品仓库。</p>

<p><strong>ECS</strong>：是一种由 CPU、内存、云盘组成的资源集合，每一种资源都会逻辑对应到数据中心的计算硬件实体。</p>

<p><strong>ACR</strong>：阿里云镜像仓库服务。</p>

<p><strong>ACK</strong>：阿里云容器服务 Kubernetes 版提供高性能可伸缩的容器应用管理能力，支持企业级容器化应用的全生命周期管理。</p>

<p><strong>ACI</strong>：ACI 全称 Ant Continuous Integration <em>（AntCI）</em> ，是蚂蚁集团研发效能旗下一款以流水线 <em>（Pipeline）</em> 为核心的 CI/CD 效能产品。使用智能自动化构建、测试和部署，提供了以代码流为输入的轻量级持续交付解决方案，提高团队研发的工作效率。</p>

<p><strong>Private Zone</strong>：基于专有网络 VPC <em>（Virtual Private Cloud）</em> 环境的私有 DNS 服务。该服务允许在自定义的一个或多个 VPC 中将私有域名映射到 IP 地址。</p>

<p><strong>P2P</strong>：点对点技术，当 P2P 网络中某一个 Peer 从 Server 下载数据的时候，下载完数据后也能当作服务端供其他 Peer 下载。当大量节点同时下载的时候，能保证后续下载的数据，可以不用从 Server 端下载。从而减轻 Server 端的压力。</p>

<p><strong>Dragonfly</strong>：Dragonfly 是⼀款基于 P2P 技术的文件分发和镜像加速系统，并且是云原生架构中镜像加速领域的标准解决方案以及最佳实践。现在为云原生计算机基金会 <em>（CNCF）</em> 托管作为孵化级项目。</p>

<p><strong>Nydus</strong>：Nydus 镜像加速框架是 Dragonfly 的子项目，它提供了容器镜像按需加载的能力，在生产环境支撑了每日百万级别的加速镜像容器创建，在启动性能，镜像空间优化，端到端数据一致性，内核态支持等方面相比 OCIv1 有巨大优势。</p>

<p><strong>LifseaOS</strong>：面向容器场景，阿里云推出轻量、快速、安全、镜像原子管理的容器优化操作系统，相比传统操作系统软件包数量减少 60%，镜像大小减少 70%，OS 首次启动从传统 OS 的 1min 以上下降到了 2s 左右。支持镜像只读和 OSTree 技术，将 OS 镜像版本化管理，更新操作系统上的软件包、或者固化的配置时，以整个镜像为粒度进行更新。</p>

<p><strong>方案设计</strong></p>

<p><strong>解决镜像大的问题</strong></p>

<p><strong>1. 精简基础</strong> <strong>镜像</strong> <strong>大小</strong></p>

<p>基础 OS 从 CentOS 7 改为 AnolisOS 8，精简运维工具的安装，只默认安装一些必须的工具列表 <em>（基础运维工具、运行时通用依赖、日志清理、安全基线等组件）</em> ，并简化安全加固的配置，基础镜像从 1.63GB 减少到 300MB。</p>

<p>AnolisOS 仓库：<a href="https://hub.docker.com/r/openanolis/anolisos/tags"><em>https://hub.docker.com/r/openanolis/anolisos/tags</em></a></p>

<p><strong>2. Dockerfile 优化</strong></p>

<p>通过 Dockerfile 编写约束、镜像检测等手段减少不必要的构建资源和时间。</p>

<p>Dockerfile 最佳实践原则: <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/"><em>https://docs.docker.com/develop/develop-images/dockerfile_best-practices/</em></a></p>

<p><strong>3. 并行构建和构建缓存</strong></p>

<p>蚂蚁构建中心采用 Nydus 社区优化版的 BuildKit[2]，BuildKit 支持 layer 级别缓存，准确引用先前的产出物并进行缓存匹配，使用方法与普通镜像并无区别，对于 Multistage 类型 Dockerfile，BuildKit 可以实现不同 stage 之间的并行执行。</p>

<p><strong>推送到云上镜像仓库耗时长</strong></p>

<p><strong>1. 使用 Nydus 镜像进行块级别数据去重</strong></p>

<p>传统 OCI 镜像，不同镜像之间可以共享的最小单位是镜像中的层，在 deduplication 上的效率是非常低的，层内部存在重复的数据，层与层之间可能存在大量重复的数据，即使有微小的差别，也会被作为不同的层，根据 OCI Image Spec 对删除文件和 Hard Link 的设计，一个镜像内部可能存在已经被上层删除的文件仍然存在于下层中，并包含在镜像中。另外 OCI Image 使用了 tar+gzip 格式来表达镜像中的层，而 tar 格式并不区分 tar archive entries ordering，这带来一个问题即如果用户在不同机器上 build 去同一个镜像，最终可能会因为使用了不同的文件系统而得到不同的镜像，但若干不同镜像的实质内容是完全相同的情况，导致上传下载数据量飙增。</p>

<p>OCIv1 存在的问题与 OCIv2 提案：<a href="https://hackmd.io/@cyphar/ociv2-brainstorm"><em>https://hackmd.io/@cyphar/ociv2-brainstorm</em></a></p>

<p>Nydus 镜像文件以文件 Chunk 为粒度分割，扁平化元数据层 <em>（移除中间层</em> <em>）</em> ，每一个 Chunk 在镜像中只会保存一次，可指定 Base Image , 用作其他 Nydus Image 的 Chunk dictionary，基于 Chunk level deduplication 提供了在不同镜像之间低成本的 data 去重能力，大大降低了镜像的上传和下载数据量。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae9ef891d3a441b7b4f3286a83e6416d~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>Nydus 镜像块共享</p>

<p>如上图 Nydus 镜像 1 和镜像 2 存在相同的数据块 B2、C、E1、F，镜像 2 新增 E2、G1、H1、H2，如果镜像仓库已经存在镜像 1，那么镜像 2 可以基于镜像 1 进行镜像构建，仅需要将 E2、G1、H1、H2 构建在一层，在上传的时候仅需要将这一层上传到镜像仓库，达到仅文件差异上传、拉取的效果，缩短研发周期。</p>

<p><strong>2. 直接构建云上 Nydus 镜像</strong></p>

<p>目前在大多数加速镜像的落地场景中，加速镜像的生产都是基于镜像转换的。目前落地的 Nydus 转换方案主要为以下两种：</p>

<p>i. 镜像仓库转换</p>

<p>普通镜像构建完成并 push 到镜像仓库后，触发镜像仓库的转换动作，完成镜像转换。这种方案的缺点在于，构建和转换往往在不同机器上进行。镜像构建并 push 后，还需要 pull 到转换机并将产出 push 到镜像仓库，需要增加一次完整的镜像流转过程，延迟较高，而且还占用镜像仓库的网络资源。在加速镜像转换完成前，应用发布并无法享受加速效果，仍需要完整 pull 镜像。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9c6763a9f63b41bdb8e961fb101ff31b~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>ii. 双版本构建</p>

<p>在普通镜像构建完成后，在构建机本地直接转换。为提高效率，可以在每层构建完成后即开始对该层进行转换，加速镜像生成延迟可以大幅降低。这个方案，无需等待普通镜像上传即可开始转换，而且在本地转换，相比较方案 1，可以省掉的转换机镜像传输的开销。如果基础镜像对应的加速镜像不存在，则将其转换出来；如果存在，pull 可以忽略不计，但是无可避免的是 push 总是需要双份。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d04dea6f79e4453f8de63f8ed9d1ad42~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>iii. 直接构建</p>

<p>上述两种基于转换的方案，与直接构建 Nydus 加速镜像相比，都有明显的生产延迟。一是基于 OCI 的镜像构建速度明显慢于 Nydus 镜像构建；二是转换是事后行为，都存在或多或少的滞后；三是都存在额外的数据传输。而直接构建，流程少，速度快，又节约资源：</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/180b1184c91e421d8a1565d750e86744~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>可以看出，加速镜像构建，步骤明显减少，数据传输量明显减少，构建完成后即可直接享受加速镜像的能力，应用发布速度可以大幅提升。</p>

<p><strong>镜像启动慢</strong></p>

<p><strong>1. Nydus 镜像按需加载</strong></p>

<p>在容器启动时，容器内业务 IO 请求哪些文件的数据，再从远端 Registry 拉取这些数据，这样避免镜像大量数据拉取阻塞容器的启动，镜像的数据的实际使用率是很低的，比如 Cern 的这篇论文[3]中就提到，一般镜像只有 6% 的内容会被实际用到。按需加载的目的是让容器运行时有选择地从 Blob 中的镜像层 <em>（layer）</em> 下载和提取文件，但 OCI[4]/ Docker[5]镜像规范将所有的镜像层打包成一个 tar 或 tar.gz 存档，这样即使你要提取单个文件也要扫描整个 Blob。如果镜像使用 gzip 进行压缩，就更没有办法提取特定文件了。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/21904b91059542f293c37c5f6e9fe0dd~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>Nydus 镜像格式</p>

<p>RAFS 镜像格式[6]是 Nydus 提出的存档压缩格式。其中将容器镜像文件系统的数据 <em>（</em> <em>Blobs）</em> 和元数据 <em>（</em> <em>Bootstrap）</em> 分离，让原来的镜像层只存储文件的数据部分。并且把文件以 Chunk 为粒度分割，每层 Blob 存储对应的 Chunk 数据；因为采用了 Chunk 粒度，这细化了去重粒度，Chunk 级去重让层与层之间，镜像与镜像之间共享数据更容易，也更容易实现按需加载。原来的镜像层只存储文件的数据部分 <em>（也就是图中的 Blob 层）</em> 。Blob 层存储的是文件数据的切块 <em>（Chunk）</em> ，例如将一个 10MB 的文件，切割成 10 个 1MB 的块，于是就可以将 Chunk 的 Offset 记录在一个索引中，容器在请求文件的部分数据时，通过结合 OCI/Docker 镜像仓库规范支持的 HTTP Range Request，容器运行时可以有选择地从镜像仓库中获取文件，如此一来节省不必要的网络开销。关于 Nydus 镜像格式的更多细节，请参考 Nydus Image Service 项目[7]。</p>

<p>元数据和 Chunk 的索引加在一起，就组成了上图中的 Meta 层，它是所有镜像层堆叠后容器能看到的整个 Filesystem 结构，包含目录树结构，文件元数据，Chunk 信息 <em>（块的大小和偏移量，以及每个文件的元数据（名称、文件类型、所有者等））</em> 。有了 Meta 之后，就可以在不扫描整个存档文件的情况下提取需要的文件。另外，Meta 层包含了 Hash 树以及 Chunk 数据块的 Hash，以此来保证我们可以在运行时对整颗文件树校验，以及针对某个 Chunk 数据块做校验，并且可以对整个 Meta 层签名，以保证运行时数据被篡改后依然能够被检查出来。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dc85339e743f40ad85bc959630fc9804~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>Nydus 按需加载</p>

<p>Nydus 默认使用用户态文件系统实现 FUSE[8]来做按需加载，用户态的 Nydus Daemon 进程将 Nydus 镜像挂载点作为容器 RootFS 目录，当容器产生 <code>read(fd,count)</code> 之类的文件系统 IO 时，内核态 FUSE 驱动将该请求加入处理队列，用户态 Nydus Daemon 通过 FUSE Device 读取并处理该请求，从远端 Registry 拉取 Count 对应数量的 Chunk 数据块后，最终通过内核态 FUSE 回复给容器。Nydus 还实现了一层本地 Cache，已经从远端拉取的 Chunk 会解压缩后缓存在本地，Cache 可以做到以层为单位在镜像之间共享，也可以做到 Chunk 级别的共享。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/153eb1452499489ab98209b58171446a~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>从 Pod 创建到容器启动</p>

<p>利用 Nydus 做镜像加速后，不同应用的启动时间都有了质的飞跃，能够在非常短的时间内拉起应用，满足云上快速伸缩的要求。</p>

<p><strong>2. 只读文件系统 EROFS</strong></p>

<p>当容器镜像中存在大量文件时，频繁的文件操作会产生大量的 FUSE 请求，造成内核态/用户态上下文的频繁切换，造成性能瓶颈；依托于内核态 EROFS <em>（</em> <em>始于 Linux 4.19）</em> 文件系统，Nydus 对其进行了一系列的改进与增强，拓展其在镜像场景下的能力，最终呈现为一个内核态的容器镜像格式，Nydus RAFS <em>（Registry Acceleration File System）</em> v6，相比于此前的格式，它具备块数据对齐，元数据更加精简，高可扩展性与高性能等优势。在镜像数据全部下载到本地的情况下，FUSE 用户态方案会导致访问文件的进程频繁陷出到用户态，并涉及内核态/用户态之间的内存拷贝，更进一步支持了 EROFS over FS-Cache 方案 <em>（Linux 5.19-rc1）</em> ，当用户态 Nydusd 从远端下载 Chunk 后会直接写入 FS-Cache 缓存，之后容器访问时，能够直接通过内核态 FS-Cache 读取数据，而无需陷出到用户态，在容器镜像的场景下实现几乎无损的性能和稳定性，其表现优于 FUSE 用户态方案，同时与原生文件系统 <em>（未使用按需加载）</em> 的性能相近。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ffc82a5d43044cb69326bea80af5e3e3~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>不同文件系统方案耗时对比</p>

<p>目前 Nydus 在构建，运行，内核态 <em>（</em> <em>Linux 5.19-rc1）</em> 均已支持了该方案，详细用法可以参见 Nydus EROFS FS-Cache user guide[9]，另外想了解更多 Nydus 内核态实现细节，可以参见 Nydus 镜像加速之内核演进之路[10]。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4785cdcb3c14d279c3b219d0447b355~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>Nydus 内核实现细节</p>

<p><strong>3. Dragonfly P2P 加速镜像下载</strong></p>

<p>不论是镜像仓库服务本身还是背后的存储，最终肯定是有带宽和 QPS 限制的。如果单纯依赖服务端提供的带宽和 QPS，很容易就无法满足需求。因此需要引入 P2P，减轻服务端压力，进而满足大规模并发拉取镜像的需求。在大规模拉镜像的场景下，在使用 Dragonfly&amp;Nydus 场景对比 OCIv1 场景能够节省 90% 以上的容器启动时间。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ef364f01f81244b1a0e2add3e418e3d8~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>Dragonfly P2P 镜像加速拉取</p>

<p>使用 Nydus 之后启动时间更短是因为镜像 Lazyload 的特性，只需要拉取很小的一部分元数据 Pod 就能启动。在大规模场景下，使用 Dragonfly 回源拉取镜像的数量很少。OCIv1 的场景所有的镜像拉取都要回源，因此使用 Dragonfly 回源峰值和回源流量相比 OCIv1 的场景少很多。并且使用 Dragonfly 后随着并发数提高，回源峰值和流量不会显著提高。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/41a4e7c52d39425c90e57564f3bedbca~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>1G 大小的随机文件测试</p>

<p><strong>集群伸缩时间长</strong></p>

<p><strong>1. ACR 镜像仓库全球同步</strong></p>

<p>为了满足客户优质的体验以及数据合规需求，需要就近接入，因此 ZOLOZ 在全球多个站点进行云上部署。借助 ACR 镜像仓库进行跨境同步加速，全球多地域间同步，提高容器镜像分发效率。上传和下载镜像都在本区域机房内进行，特别是在一些网络不太好的国家内，也能够像本地机房一样进行部署，真正做到应用的一键部署到全球各地。</p>

<p><strong>2. 采用 ContainerOS 极速启动</strong></p>

<p>借助云原生满足客户急速增长资源扩容，利用弹性降低成本，在云上需要极速伸缩虚拟机，并将其加入到集群内部。ContainerOS 通过简化 OS 启动流程，预置集群管控必备组件的容器镜像以减少节点启动过程中因镜像拉取而带来的耗时，极大地提高了 OS 启动速度，降低了 ACK 链路中的节点扩容时间。ContainerOS 从如下几个方面进行了优化：</p>

<ul>
<li><p>ContainerOS 通过简化 OS 启动流程，有效降低 OS 启动时间。ContainerOS 的定位是跑在云上虚拟机的操作系统，不会涉及到太多的硬件驱动，因此 ContainerOS 将必要的内核驱动模块修改为 built-in 模式。此外，ContainerOS 去除了 initramfs，且 udev 规则也被大大简化，此时 OS 启动速度得到了大幅提升。以 ecs.g7.large 规格的 ECS 实例为例，LifseaOS 的首次启动时间保持在 2s 左右，而 Alinux3 则需要 1min 以上。</p></li>

<li><p>ContainerOS 通过预置集群管控必备组件的容器镜像以减少节点启动过程中因镜像拉取而带来的耗时。ECS 节点启动完成后需要拉取部分组件的容器镜像，这些组件负责在 ACK 场景下执行一些基础性的工作。例如 Terway 组件负责网络，节点必须在 Terway 组件的容器就绪的情况下才能转换为就绪状态。因此，既然网络拉取的长尾效应会带来极大的耗时，那么可以通过预置的方式提前将此组件提前安装在 OS 内部，此时可直接从本地目录获取，避免网络拉取镜像耗时。</p></li>

<li><p>ContainerOS 也会通过结合 ACK 管控链路优化，提高节点弹性性能。</p></li>
</ul>

<p>最终，统计了从空的 ACK 节点池扩容的端到端的 P90 耗时，从下发扩容请求开始计时，到 90% 的节点处于就绪状态结束计时，并对比了 CentOS、Alinux2 Optimized-OS[11]方案，ContainerOS 性能优势明显，具体数据如下图所示。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/706f4ff45dce49dd8264a9eeb131048e~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p align=center>ecs.c6.xlarge 并发启动数据</p>

<p><strong>整体链路</strong></p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0c29d27c0be0402587e164c1e073e91a~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p align=center>ZOLOZ 公有云应用部署整体方案</p>

<ul>
<li><p>通过精简基础镜像以及遵循 Dockerfile 规约，对镜像大小进行精简。</p></li>

<li><p>利用蚂蚁托管的 BuildKit 对镜像进行 Multistage 并行构建，在重复构建时采用缓存加快镜像构建。直接构建 Nydus 加速镜像时通过镜像之间重复分析进行去重，仅上传镜像之间差异的块到远程镜像仓库。</p></li>

<li><p>通过 ACR 全球加速同步的能力，将镜像分发到全球不同的镜像仓库中，进行就近拉取。</p></li>

<li><p>通过 Dragonfly P2P 网络对 Nydus 镜像块进行按需加速拉取。</p></li>

<li><p>节点上使用 ContainerOS 操作系统，提高 OS 启动速度以及镜像启动速度。</p></li>
</ul>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5cbf06446ed840b5b36819ac98a0135d~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>容器研发流程</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/acb67f7330714d188c552ab1c06b0b2c~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p>以 3G 镜像为例</p>

<p>*调度时间：该时间是指从阿里云创建一台 ECS，到节点加入到 K8s 集群并 Ready 的时间，得益于 ContainerOS 的优化，该耗时降低非常明显。</p>

<p>通过对研发全流程各个环节进行极致的优化，可以发现优化后，研发效率和线上稳定性都得到了质的提升，目前整套方案已经在阿里云和 AWS 都完成了部署，线上稳定运行 3 个月，未来将在云厂商提供标准的部署环境，满足更多类型的业务场景。</p>

<p><strong>使用指南</strong></p>

<p><strong>镜像构建</strong></p>

<p>代码资产都在蚂蚁域内，利用蚂蚁镜像构建中心托管的 BuildKit 集群，通过自定义的 ACI 组件进行构建 Nydus 镜像。</p>

<pre><code class="language-bash">镜像构建:  stage: 镜像构建  id: build-image  component: nydus-image-build  inputs:    imageName: ${{parameters.imageName}} #构建的镜像 name    imageTag: ${{vcs.commitSha}} # 构建的镜像 tag，这里的 ${{vcs.commitSha}} 是 ACI 内置参数    dockerfile: Dockerfile # dockerfile文件位置（默认相对代码根目录）    chunkDictImage: ${{parameters.chunkDictImage}}    timeoutInSec: 1200
</code></pre>

<p>可以指定 Chunk Dict Image 按 Chunk 去重粒度，如果构建的镜像和 Chunk Dict Image。Image Name 可以直接指定阿里云 ACR 仓库，构建的 Nydus 镜像直接推送到云上，减少镜像中转耗时。</p>

<p><strong>Dragonfly 安装</strong></p>

<pre><code class="language-bash">$ helm repo add dragonfly https://dragonflyoss.github.io/helm-charts/$ helm install --wait --timeout 10m --dependency-update --create-namespace --namespace dragonfly-system dragonfly dragonfly/dragonfly --set dfdaemon.config.download.prefetch=true,seedPeer.config.download.prefetch=trueNAME: dragonflyLAST DEPLOYED: Fri Apr  7 10:35:12 2023NAMESPACE: dragonfly-systemSTATUS: deployedREVISION: 1TEST SUITE: NoneNOTES:1. Get the scheduler address by running these commands:  export SCHEDULER_POD_NAME=$(kubectl get pods --namespace dragonfly-system -l &quot;app=dragonfly,release=dragonfly,component=scheduler&quot; -o jsonpath={.items[0].metadata.name})  export SCHEDULER_CONTAINER_PORT=$(kubectl get pod --namespace dragonfly-system $SCHEDULER_POD_NAME -o jsonpath=&quot;{.spec.containers[0].ports[0].containerPort}&quot;)  kubectl --namespace dragonfly-system port-forward $SCHEDULER_POD_NAME 8002:$SCHEDULER_CONTAINER_PORT  echo &quot;Visit http://127.0.0.1:8002 to use your scheduler&quot;
2. Get the dfdaemon port by running these commands:  export DFDAEMON_POD_NAME=$(kubectl get pods --namespace dragonfly-system -l &quot;app=dragonfly,release=dragonfly,component=dfdaemon&quot; -o jsonpath={.items[0].metadata.name})  export DFDAEMON_CONTAINER_PORT=$(kubectl get pod --namespace dragonfly-system $DFDAEMON_POD_NAME -o jsonpath=&quot;{.spec.containers[0].ports[0].containerPort}&quot;)  You can use $DFDAEMON_CONTAINER_PORT as a proxy port in Node.
3. Configure runtime to use dragonfly:  https://d7y.io/docs/getting-started/quick-start/kubernetes/
</code></pre>

<p>更多详情参考：<a href="https://d7y.io/zh/docs/setup/integration/nydus"><em>https://d7y.io/zh/docs/setup/integration/nydus</em></a></p>

<p><strong>Nydus 安装</strong></p>

<pre><code class="language-bash">$ curl -fsSL -o config-nydus.yaml https://raw.githubusercontent.com/dragonflyoss/Dragonfly2/main/test/testdata/charts/config-nydus.yaml$ helm install --wait --timeout 10m --dependency-update --create-namespace --namespace nydus-snapshotter nydus-snapshotter dragonfly/nydus-snapshotter -f config-nydus.yamlNAME: nydus-snapshotterLAST DEPLOYED: Fri Apr  7 10:40:50 2023NAMESPACE: nydus-snapshotterSTATUS: deployedREVISION: 1TEST SUITE: NoneNOTES:Thank you for installing nydus-snapshotter.
Your release is named nydus-snapshotter.
To learn more about the release, try:
  $ helm status nydus-snapshotter  $ helm get all nydus-snapshotter
</code></pre>

<p>更多详情参考：<a href="https://github.com/dragonflyoss/helm-charts/blob/main/INSTALL.md"><em>https://github.com/dragonflyoss/helm-charts/blob/main/INSTALL.md</em></a></p>

<p><strong>ContainerOS 使用</strong></p>

<p>ContainerOS 针对 ACK 集群节点池的弹性扩容场景，实现了极速扩容的特性。一方面，LifseaOS 通过简化 OS 本身的启动流程提高了 OS 启动速度。它裁剪掉了大量云上场景无需的硬件驱动，必要的内核驱动模块修改为 built-in 模式，去除了 initramfs，udev 规则也被大大简化，OS 首次启动时间从传统 OS 的 1min 以上下降到了 2s 左右。另一方面，ContainerOS 结合 ACK 场景进行了定制优化。它通过预置集群管控必备组件的容器镜像以减少节点启动过程中因镜像拉取而带来的耗时，并结合 ACK 管控链路优化（例如调节关键逻辑的检测频率、调整高负载下系统瓶颈中的限流值等），极大地提高了节点扩容速度。在阿里云控制台上为 ACK 集群建立托管节点池[12]时，在配置菜单中可以选择 ECS 实例的操作系统，下拉选择 ContainerOS 即可，OS 镜像名字中的 1.24.6 对应的是集群的 K8s 版本。另外，如果您需要高性能的节点池弹性扩容能力，为了实现最佳的节点扩容性能，更多信息请参见使用 ContainerOS 实现节点极速扩容[13]。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f3b26fa56e64084807d7dcd59c3daf0~tplv-k3u1fbpfcp-zoom-1.image" alt="图片" /></p>

<p><strong>注意事项</strong></p>

<p>ContainerOS 目前仅支持 Kubernetes 1.24.6 及以上版本，需要在创建 ACK 集群，或升级 ACK 集群的 K8s 版本[14]为 1.24.6 及以上版本方可使用。ContainerOS 预置了影响 Node Ready 和 Pod Ready 的必备的组件，如 Flannel、Terway 等网络插件。原本节点启动后需要拉取并启动这些组件的容器镜像，节点才会处于就绪状态，预置之后便无需从网络上拉取。但是，为了防止集群的组件版本与预置的组件版本不一致的情况，请参考注意事项[15]。</p>

<p><strong>参考资料</strong></p>

<ul>
<li><p><a href="https://github.com/containerd/containerd"><em>https://github.com/containerd/containerd</em></a></p></li>

<li><p><a href="https://github.com/dragonflyoss/Dragonfly2"><em>https://github.com/dragonflyoss/Dragonfly2</em></a></p></li>

<li><p><a href="https://d7y.io/"><em>https://d7y.io/</em></a></p></li>

<li><p><a href="https://github.com/dragonflyoss/image-service"><em>https://github.com/dragonflyoss/image-service</em></a></p></li>

<li><p><a href="https://nydus.dev/"><em>https://nydus.dev/</em></a></p></li>

<li><p><a href="https://github.com/goharbor/harbor"><em>https://github.com/goharbor/harbor</em></a></p></li>

<li><p><a href="https://www.alibabacloud.com/help/zh/container-registry"><em>https://www.alibabacloud.com/help/zh/container-registry</em></a></p></li>

<li><p><a href="https://github.com/moby/moby/tree/master/image/spec"><em>https://github.com/moby/moby/tree/master/image/spec</em></a></p></li>

<li><p><a href="https://docs.docker.com/registry/spec/manifest-v2-1/"><em>https://docs.docker.com/registry/spec/manifest-v2-1/</em></a></p></li>

<li><p><a href="https://docs.docker.com/registry/spec/manifest-v2-2/"><em>https://docs.docker.com/registry/spec/manifest-v2-2/</em></a></p></li>

<li><p><a href="https://github.com/opencontainers/image-spec/blob/main/layer.md#representing-changes"><em>https://github.com/opencontainers/image-spec/blob/main/layer.md#representing-changes</em></a></p></li>

<li><p><a href="https://github.com/opencontainers/image-spec/blob/main/manifest.md"><em>https://github.com/opencontainers/image-spec/blob/main/manifest.md</em></a></p></li>

<li><p><a href="https://www.usenix.org/conference/fast16/technical-sessions/presentation/harter"><em>https://www.usenix.org/conference/fast16/technical-sessions/presentation/harter</em></a></p></li>

<li><p><a href="https://www.kernel.org/doc/html/latest/filesystems/fuse.html"><em>https://www.kernel.org/doc/html/latest/filesystems/fuse.html</em></a></p></li>

<li><p><a href="https://virtio-fs.gitlab.io/"><em>https://virtio-fs.gitlab.io/</em></a></p></li>

<li><p><a href="https://www.kernel.org/doc/html/latest/filesystems/erofs.html"><em>https://www.kernel.org/doc/html/latest/filesystems/erofs.html</em></a></p></li>

<li><p><a href="https://github.com/dragonflyoss/image-service/blob/fscache/docs/nydus-fscache.md"><em>https://github.com/dragonflyoss/image-service/blob/fscache/docs/nydus-fscache.md</em></a></p></li>

<li><p><a href="https://mp.weixin.qq.com/s/w7lIZxT9Wk6-zJr23oBDzA"><em>https://mp.weixin.qq.com/s/w7lIZxT9Wk6-zJr23oBDzA</em></a></p></li>

<li><p><a href="https://static.sched.com/hosted_files/kccncosschn21/fd/EROFS_What_Are_We_Doing_Now_For_Containers.pdf"><em>https://static.sched.com/hosted_files/kccncosschn21/fd/EROFS_What_Are_We_Doing_Now_For_Containers.pdf</em></a></p></li>

<li><p><a href="https://github.com/imeoer/buildkit/tree/nydus-compression-type"><em>https://github.com/imeoer/buildkit/tree/nydus-compression-type</em></a></p></li>
</ul>

<p><strong>参考链接</strong></p>

<p>[1]ZOLOZ：<a href="https://www.zoloz.com/"><em>https://www.zoloz.com/</em></a></p>

<p>[2]BuildKit：<a href="https://github.com/moby/buildkit/blob/master/docs/nydus.md"><em>https://github.com/moby/buildkit/blob/master/docs/nydus.md</em></a></p>

<p>[3]Cern 的这篇论文：<a href="https://indico.cern.ch/event/567550/papers/2627182/files/6153-paper.pdf"><em>https://indico.cern.ch/event/567550/papers/2627182/files/6153-paper.pdf</em></a></p>

<p>[4]OCI：<a href="https://github.com/opencontainers/image-spec/"><em>https://github.com/opencontainers/image-spec/</em></a></p>

<p>[5]Docker：<a href="https://github.com/moby/moby/blob/master/image/spec/v1.2.md"><em>https://github.com/moby/moby/blob/master/image/spec/v1.2.md</em></a></p>

<p>[6]RAFS 镜像格式：<a href="https://d7y.io/zh/blog/2022/06/06/evolution-of-nydus/#rafs-v6-镜像格式"><em>https://d7y.io/zh/blog/2022/06/06/evolution-of-nydus/#rafs-v6-镜像格式</em></a></p>

<p>[7]Nydus Image Service 项目：<a href="https://github.com/dragonflyoss/image-service"><em>https://github.com/dragonflyoss/image-service</em></a></p>

<p>[8]FUSE：<a href="https://www.kernel.org/doc/html/latest/filesystems/fuse.html"><em>https://www.kernel.org/doc/html/latest/filesystems/fuse.html</em></a></p>

<p>[9]Nydus EROFS fscache user guide：<a href="https://github.com/dragonflyoss/image-service/blob/master/docs/nydus-fscache.md"><em>https://github.com/dragonflyoss/image-service/blob/master/docs/nydus-fscache.md</em></a></p>

<p>[10]Nydus 镜像加速之内核演进之路：<a href="https://mp.weixin.qq.com/s/w7lIZxT9Wk6-zJr23oBDzA"><em>https://mp.weixin.qq.com/s/w7lIZxT9Wk6-zJr23oBDzA</em></a></p>

<p>[11]Alinux2 Optimized-OS：<a href="https://help.aliyun.com/document_detail/206271.html"><em>https://help.aliyun.com/document_detail/206271.html</em></a></p>

<p>[12]托管节点池：<a href="https://help.aliyun.com/document_detail/190616.html"><em>https://help.aliyun.com/document_detail/190616.html</em></a></p>

<p>[13]使用 ContainerOS 实现节点极速扩容：<a href="https://www.alibabacloud.com/help/zh/container-service-for-kubernetes/latest/add-containeros-nodes-to-autoscale"><em>https://www.alibabacloud.com/help/zh/container-service-for-kubernetes/latest/add-containeros-nodes-to-autoscale</em></a></p>

<p>[14]升级 ACK 集群的 K8s 版本：<a href="https://help.aliyun.com/document_detail/86497.html"><em>https://help.aliyun.com/document_detail/86497.html</em></a></p>

<p>[15]注意事项：<a href="https://help.aliyun.com/document_detail/607514.html#section-832-c5w-8gy"><em>https://help.aliyun.com/document_detail/607514.html#section-832-c5w-8gy</em></a></p>

<p><strong>了解更多&hellip;</strong></p>

<p><strong>Nydus Star 一下✨：</strong><a href="https://github.com/dragonflyoss/image-service"><em>https://github.com/dragonflyoss/image-service</em></a></p>

</article>

<script>
  const article = document.querySelector('article.typo')
  
  const imgElements = article.querySelectorAll('img');
  
  imgElements.forEach(img => {
    const src = img.getAttribute('src');
    
    
      
    
    img.setAttribute('referrerpolicy', 'no-referrer');
  });
</script>


		<div class="-show-mobile">
			

<nav class="ss-pagination-next">
	<a class="link-prev" href="https://sofastack.github.io/sofastack.tech/blog/sofa-weekly-0421/">
		<span class="text">上一篇: </span>
		<span class="text">SOFA Weekly｜SOFARPC 5.10.0 版本发布、SOFA 五周年回顾、Layotto 社区会议回顾与预告</span>
	</a>
	<a class="link-next" href="https://sofastack.github.io/sofastack.tech/blog/sofa-weekly-20230428/">
		<span class="text">下一篇: </span>
		<span class="text">SOFA Weekly｜SOFAArk 社区会议预告、Layotto 社区会议回顾、社区本周贡献</span>
	</a>
</nav>

		</div>
	</main>

	<aside class="ss-layout-aside">
		
		


<div class="ss-card">
	<h2 class="card-title">
		相关推荐
	</h2>
	
	<ul class="ss-aside-related">
		
			<li><a href="/sofastack.tech/blog/moe-series-2golang-extensions-receive-configuration-from-envoy/">MoE 系列（二）｜Golang 扩展从 Envoy 接收配置</a></li>
		
			<li><a href="/sofastack.tech/activities/sofa-anniversary-5/">SOFA 五周年，Live Long and Prosper！</a></li>
		
			<li><a href="/sofastack.tech/blog/originsants-practical-path-to-application-level-service-discovery/">缘起｜蚂蚁应用级服务发现的实践之路</a></li>
		
			<li><a href="/sofastack.tech/projects/sofa-registry/code-analyze/origins-ant-s-practical-path-to-application-level-service-discovery/">缘起｜蚂蚁应用级服务发现的实践之路</a></li>
		
			<li><a href="/sofastack.tech/blog/moe-series-1how-to-extend-envoy-with-golang/">MoE 系列（一）｜如何使用 Golang 扩展 Envoy</a></li>
		
	</ul>
	
</div>

		<div class="ss-aside-tags ss-card">
	<h2 class="card-title">
		标签
		<span class="card-extra"></span>
	</h2>
	<ul class="tag-list">
		
			<li class="tag"><a href="/sofastack.tech/tags/1024/">1024</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/api-gateway/">API Gateway </a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/cafedeployment/">CafeDeployment</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/cloud-native/">Cloud Native</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/cncf/">CNCF</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/db-mesh/">DB Mesh</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/dragonfly/">Dragonfly</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/elasticdl/">ElasticDL</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/http/3/">HTTP/3</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/http/quic/">HTTP/QUIC</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/kata-container/">Kata Container</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/kata-containers/">Kata Containers</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/knative/">Knative</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/kubecon/">KubeCon</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/kubernetes/">Kubernetes</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/meetup/">Meetup</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/mosn/">MOSN</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/nydus/">Nydus</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/occlum/">Occlum</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/rpc-%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E8%80%83%E5%92%8C%E9%87%8F/">RPC 框架设计的考和量</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/seata/">Seata</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/serverless/">Serverless</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/serverlesstask/">ServerlessTask</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/service-mesh/">Service Mesh</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/service-mesh-meetup/">Service Mesh Meetup</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/service-mesh-virtual-meetup/">Service Mesh Virtual Meetup</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/service-mesh-webinar/">Service Mesh Webinar</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/service-mesh-%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">Service Mesh 落地实践</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sidecar-%E5%AE%B9%E5%99%A8/">Sidecar 容器</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofa/">SOFA</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofa-weekly/">SOFA Weekly</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofaacts/">SOFAActs</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofaark/">SOFAArk</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofaarklab/">SOFAArkLab</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofabolt/">SOFABolt</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofaboot/">SOFABoot</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofachannel/">SOFAChannel</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofadashboard/">SOFADashboard</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofaenclave/">SOFAEnclave</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofajraft/">SOFAJRaft</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofajraft-%E7%89%B9%E6%80%A7%E8%A7%A3%E6%9E%90/">SOFAJRaft 特性解析</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofalab/">SOFALab</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofalookout/">SOFALookout</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofameetup/">SOFAMeetup</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofamesh/">SOFAMesh</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofaregistry/">SOFARegistry</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofarpc/">SOFARPC</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofastack/">SOFAStack</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofastack-%E5%BC%80%E6%BA%90%E4%B9%8B%E5%A4%8F/">SOFAStack 开源之夏</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofastak/">SOFAStak</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofatalk/">SOFATalk</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sofatracer/">SOFATracer</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/springboot/">SpringBoot</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/sqlflow/">SQLFlow</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/summer-2021/">Summer 2021</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/workshop/">Workshop</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/zsearch/">ZSearch</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/">云原生</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/">任务调度</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E4%BD%A0%E7%9A%84%E5%BC%80%E6%BA%90%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/">你的开源入门指南</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/">分布式事务</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%84/">分布式架构</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%89%96%E6%9E%90-sofaark-%E6%BA%90%E7%A0%81/">剖析 | SOFAArk 源码 </a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%89%96%E6%9E%90-sofabolt-%E6%A1%86%E6%9E%B6/">剖析 | SOFABolt 框架</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%89%96%E6%9E%90-sofaboot-%E6%A1%86%E6%9E%B6/">剖析 | SOFABoot 框架</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%89%96%E6%9E%90-sofajraft-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/">剖析 | SOFAJRaft 实现原理</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%89%96%E6%9E%90-sofaregistry-%E6%A1%86%E6%9E%B6/">剖析 | SOFARegistry 框架</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%89%96%E6%9E%90-sofarpc-%E6%A1%86%E6%9E%B6/">剖析 | SOFARPC 框架</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%89%96%E6%9E%90-sofatracer-%E6%A1%86%E6%9E%B6/">剖析 | SOFATracer 框架</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%AE%9E%E8%B7%B5/">实践</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%BC%80%E6%BA%90/">开源</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%BC%80%E6%BA%90%E4%B9%8B%E5%A4%8F/">开源之夏</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%BC%80%E6%BA%90%E4%BA%94%E5%91%A8%E5%B9%B4/">开源五周年</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%BC%80%E6%BA%90%E5%85%AD%E5%91%A8%E5%B9%B4/">开源六周年</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%BC%80%E6%BA%90%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%BC%94%E8%BF%9B%E4%B8%8E%E6%9C%AA%E6%9D%A5/">开源容器镜像加速服务的演进与未来</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%BC%B9%E6%80%A7%E4%BC%B8%E7%BC%A9/">弹性伸缩</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E6%96%87%E4%BB%B6%E5%92%8C%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F%E7%B3%BB%E7%BB%9F/">文件和镜像加速系统</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E6%99%BA%E8%83%BD%E7%9B%91%E6%8E%A7/">智能监控</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4/">智能运维</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E6%BA%90%E5%88%9B%E4%BC%9A/">源创会</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">源码解析</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E7%B1%BB%E9%9A%94%E7%A6%BB%E6%A1%86%E6%9E%B6/">类隔离框架</a></li>
		
			<li class="tag"><a href="/sofastack.tech/tags/%E9%95%9C%E5%83%8F/">镜像</a></li>
		
	</ul>
</div>
	</aside>
</div>



	


<footer class="ss-footer">
	<div class="container">
		<div class="links">
			
				<div class="cate">
					<h2 class="cate-title">资源</h2>
					
						<a class="link" href="https://github.com/sofastack">Github</a>
					
						<a class="link" href="https://gitee.com/sofastack/">Gitee</a>
					
						<a class="link" href="https://github.com/sofastack-guides">示例</a>
					
				</div>
			
				<div class="cate">
					<h2 class="cate-title">社交媒体</h2>
					
						<a class="link" href="https://zhuanlan.zhihu.com/sofastack">知乎专栏</a>
					
						<a class="link" href="https://weibo.com/sofastack">新浪微博</a>
					
						<a class="link" href="https://twitter.com/sofastack_io">Twitter</a>
					
				</div>
			
				<div class="cate">
					<h2 class="cate-title">参与进来</h2>
					
						<a class="link" href="https://github.com/sofastack/sofastack.tech/issues/new">反馈</a>
					
						<a class="link" href="https://github.com/sofastack/community">社区</a>
					
						<a class="link" href="https://github.com/sofastack/sofastack.tech/wiki">Wiki</a>
					
						<a class="link" href="mailto:sofa@alipay.cloud.com">Email</a>
					
						<a class="link" href="/hr/">加入我们</a>
					
				</div>
			
				<div class="cate">
					<h2 class="cate-title">蚂蚁集团开源项目</h2>
					
						<a class="link" href="https://ant.design/">Ant Design</a>
					
						<a class="link" href="https://eggjs.org/">Egg </a>
					
						<a class="link" href="https://sqlflow.org">SQLFlow</a>
					
						<a class="link" href="https://tech.antfin.com/open-source">更多</a>
					
				</div>
			
		</div>
		<div class="qrcode">
			
				<div>
					<img class="qrcode-img" src="/sofastack.tech/img/qrcode/qrcode_video_2024.jpg" />
					<p class="qrcode-desc">微信视频号</p>
				</div>
			
				<div>
					<img class="qrcode-img" src="/sofastack.tech/img/qrcode/qrcode_1_2024.jpg" />
					<p class="qrcode-desc">微信公众号</p>
				</div>
			
				<div>
					<img class="qrcode-img" src="/sofastack.tech/img/qrcode/dingtalk_7.jpg" />
					<p class="qrcode-desc">钉钉群</p>
				</div>
			
		</div>
	</div>
	<div class="copyright">
		<p>
			© 2018 - 2022  The SOFAStack Authors
			<a href="http://beian.miit.gov.cn/">浙 ICP 备 16045294 号-3</a>
		</p>
	</div>
</footer>

</body>

</html>